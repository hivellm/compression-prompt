Initialize replay memory D to capacity N Initialize action-value function Q with random weights for episode = 1 M do Initialise sequence s 1 f x 1 g and preprocessed sequenced 1 s 1 T do With probability select random action otherwise select max Q Execute action in emulator and observe reward r and image x Set x and preprocess Store transition in D Sample random minibatch of transitions from D Set y r terminal r + max 0 Q 0 ) non-terminal Perform gradient descent step on y Q )) 2 according to equation 3 end for end for
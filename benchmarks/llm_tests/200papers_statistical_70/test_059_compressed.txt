Initialize replay memory D to capacity N Initialize action-value function Q with random weights for episode = 1 ; M do Initialise sequence s 1 = f x 1 g and preprocessed sequenced 1 = ( s 1 ) for = 1 T do With probability select random action otherwise select = max Q ( ( s ) ) Execute action in emulator and observe reward r and image x Set s = s x and preprocess = ( s ) Store transition ( r ) in D Sample random minibatch of transitions ( r ) from D Set y = r for terminal r + max 0 Q ( j +1 0 ) for non-terminal j +1 Perform gradient descent step on ( y j Q ( j j )) 2 according to equation 3 end for end for
Initialize replay memory D to capacity N Initialize action-value function Q with random weights for episode = 1 ; M do Initialise sequence s 1 = f x 1 g and preprocessed sequenced  1 =  ( s 1 ) for t = 1 ; T do With probability  select a random action a t otherwise select a t = max a Q  (  ( s t ) ; a ;  ) Execute action a t in emulator and observe reward r t and image x t +1 Set s t +1 = s t ; a t ; x t +1 and preprocess  t +1 =  ( s t +1 ) Store transition (  t ; a t ; r t ;  t +1 ) in D Sample random minibatch of transitions (  j ; a j ; r j ;  j +1 ) from D Set y j =  r j for terminal  j +1 r j +  max a 0 Q (  j +1 ; a 0 ;  ) for non-terminal  j +1 Perform a gradient descent step on ( y j  Q (  j ; a j ;  )) 2 according to equation 3 end for end for